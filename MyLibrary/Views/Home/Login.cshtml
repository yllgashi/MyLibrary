@model MyLibrary.Models.User

<link rel="stylesheet" type="text/css" href="~/css/login.css" />

<script>
    const saveToken = async () => {
        let email = document.getElementById("email").value;
        let password = document.getElementById("password").value;

        var response = await fetch(window.location.origin + '/login', {
            method: 'POST',
            body: JSON.stringify({
                Email: email,
                Password: password
            }),
            headers: {
                'Content-Type': 'application/json'
            }
        });

        if (response.status === 401 || response.status === 403) {
            window.location.href = window.location.origin + '/login'
        }

        const json = await response.json();

        localStorage.setItem("_token", json["token"]);

        window.location.href = window.location.origin + '/'
    }
</script>

<div class="container h-100 justify-content-center align-content-center mt-3">
    <form asp-action="Authenticate">

        <div class="form-container">
            <div class="input-container form-group">
                <label>Username : </label>
                <input asp-for="Email" class="form-control" required id="email" />
                <span asp-validation-for="Email" class="text-danger"></span>
            </div>
            <div class="input-container form-group">
                <label>Password : </label>
                <input asp-for="Password" class="form-control" required id="password" />
                <span asp-validation-for="Password" class="text-danger"></span>
            </div>
            <div class="button-container">
                @*<button type="submit" asp-action="Authenticate" class="btn btn-lg btn-success btn-block">Login</button>*@
                <button type="button" onclick="saveToken()" class="btn btn-lg btn-success">Login</button>
                <button type="button" class="btn btn-lg btn-info">Register</button>
            </div>
        </div>
    </form>
</div>